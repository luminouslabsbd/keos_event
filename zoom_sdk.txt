<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <title>Zoom Meeting SDK Sample JavaScript</title>
    <style>
        html,
        body {
            min-width: 0 !important;
        }

        #zmmtg-root {
            display: none;
            min-width: 0 !important;
        }

        main {
            width: 70%;
            margin: auto;
            text-align: center;
        }

        main button {
            margin-top: 20px;
            background-color: #2D8CFF;
            color: #ffffff;
            text-decoration: none;
            padding-top: 10px;
            padding-bottom: 10px;
            padding-left: 40px;
            padding-right: 40px;
            display: inline-block;
            border-radius: 10px;
            cursor: pointer;
            border: none;
            outline: none;
        }

        main button:hover {
            background-color: #2681F2;
        }
    </style>
</head>

<body>

    <main>
        <h1>Zoom Meeting SDK Sample JavaScript</h1>

        <!-- For Component View -->
        <div id="meetingSDKElement">
            <!-- Zoom Meeting SDK Rendered Here -->
        </div>

        <button onClick="getSignature()">Join Meeting</button>
    </main>

    <!-- Dependencies for client view and component view -->
    <script src="https://source.zoom.us/3.1.6/lib/vendor/react.min.js"></script>
    <script src="https://source.zoom.us/3.1.6/lib/vendor/react-dom.min.js"></script>
    <script src="https://source.zoom.us/3.1.6/lib/vendor/redux.min.js"></script>
    <script src="https://source.zoom.us/3.1.6/lib/vendor/redux-thunk.min.js"></script>
    <script src="https://source.zoom.us/3.1.6/lib/vendor/lodash.min.js"></script>

    <!-- For Client View -->
    <script src="https://source.zoom.us/zoom-meeting-3.1.6.min.js"></script>
    <script>
        ZoomMtg.preLoadWasm()
        ZoomMtg.prepareWebSDK()

        var authEndpoint = 'https://zoomsdk-sign-generator-express.onrender.com'
        var sdkKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9'
        var meetingNumber = '88454268917'
        var passWord = '8h1C4S'
        var role = 0
        var userName = 'JavaScript'
        var userEmail = 'mailto:sajjad.cse35@gmail.com'
        var registrantToken = ''
        var zakToken = ''
        var leaveUrl = 'https://zoom.us'

        function getSignature() {
            fetch(authEndpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    meetingNumber: meetingNumber,
                    role: role
                })
            }).then((response) => {
                return response.json()
            }).then((data) => {
                // console.log(data)
                startMeeting(data.signature)
            }).catch((error) => {
                console.log(error)
            })
        }

        function startMeeting(signature) {

            document.getElementById('zmmtg-root').style.display = 'block'

            ZoomMtg.init({
                leaveUrl: leaveUrl,
                patchJsMedia: true,
                success: (success) => {
                    console.log(success)
                    ZoomMtg.join({
                        signature: signature,
                        sdkKey: sdkKey,
                        meetingNumber: meetingNumber,
                        passWord: passWord,
                        userName: userName,
                        userEmail: userEmail,
                        // tk: registrantToken,
                        // zak: zakToken,
                        success: (success) => {
                            console.log(success)
                        },
                        error: (error) => {
                            console.log(error)
                        },
                    })
                },
                error: (error) => {
                    console.log(error)
                }
            })
        }
    </script>

    <!-- For Component View -->
    <!-- <script src="https://source.zoom.us/3.1.6/zoom-meeting-embedded-3.1.6.min.js"></script>
    <script type="text/javascript" src="component-view.js"></script> -->

</body>

</html>
